pattern <- paste0(
  "=(?<fun>.*?)\n",
  "(?<table>",
  "(?:[^=].*?\n)*",
  ")")
library(namedCapture)
library(data.table)
library(ggplot2)
ploss <- function(dt, x){
  ## need to make a new data table, otherwise ifelse may only get one
  ## element, and return only one element.
  new.dt <- data.table(dt, x)
  new.dt[, ifelse(Log==0, 0, Log*log(x)) + Linear*x + Constant]
}
getLines <- function(dt){
  line.list <- list()
  for(piece.i in 1:nrow(dt)){
    piece <- dt[piece.i,]
    mean.vec <- piece[, seq(exp(min_log_mean), exp(max_log_mean), l=1000)]
    line.list[[piece.i]] <- data.table(
      piece.i,
      piece,
      mean=mean.vec,
      log.mean=log(mean.vec),
      cost=ploss(piece, mean.vec))
  }
  do.call(rbind, line.list)
}
gdata <- function(txt){
  mat <- str_match_all_named(txt, pattern)[[1]]
  funs.list <- list()
  vlines.list <- list()
  for(row.i in 1:nrow(mat)){
    r <- mat[row.i,]
    df <- read.table(text=r[["table"]], header=TRUE)
    dt <- data.table(df)
    l <- getLines(dt)
    fun <- r[["fun"]]
    funs.list[[row.i]] <- data.table(fun, l)
    if(1 < nrow(dt)){
      vlines.list[[row.i]] <- data.table(fun, dt[-1,])
    }
  }
  list(
    funs=do.call(rbind, funs.list),
    vlines=do.call(rbind, vlines.list))
}

C1.60minless <- gdata("
=prev cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
1.00000000000000000000e+00 -3.04876615746180945621e+00 0.00000000000000000000e+00            -inf        3.555348        0.000000 -1
=min prev cost
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
1.00000000000000000000e+00 -3.04876615746180945621e+00 0.00000000000000000000e+00            -inf        1.114737             inf 59
0.00000000000000000000e+00 0.00000000000000000000e+00 -3.49806191860402737603e-01        1.114737        3.555348        1.114737 59
")
ggplot()+
  geom_vline(aes(xintercept=min_log_mean, color=fun),
             data=C1.60minless$vlines)+
  geom_line(aes(log.mean, cost, color=fun),
            size=2,
            data=C1.60minless$funs)

C1.60minenv <- gdata("
=min prev cost
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
1.00000000000000000000e+00 -3.51810493945800502047e+01 0.00000000000000000000e+00            -inf        3.560508             inf 2185
0.00000000000000000000e+00 0.00000000000000000000e+00 -9.00813432305983354809e+01        3.560508        6.666957        3.560508 2185
=cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
9.70161445320006365911e-01 -3.51810493945801212590e+01 0.00000000000000000000e+00            -inf        0.815395            -inf 0
3.48885258504707918004e-01 -3.41318950605419928479e+01 5.48651228557115233642e-01        0.815395        1.578029        0.477054 205
1.94455122044973421902e-01 -3.36620699596386785402e+01 5.55528680202168834157e-01        1.578029        1.987869        0.634275 281
1.94407072842590594730e-01 -3.36618777628291709902e+01 5.55497375365702650285e-01        1.987869        2.256400        0.634342 282
1.63127042091101570609e-01 -3.35125408418220516182e+01 5.17215713986802994029e-01        2.256400        2.487242        0.690013 319
1.61733615221987120369e-01 -3.35047568710359300326e+01 5.14615315853340749008e-01        2.487242        2.659388        0.693004 321
1.61349221602921533147e-01 -3.35023544109167019656e+01 5.13718283209791515276e-01        2.659388        2.752818        0.693978 325
1.60388237555256829570e-01 -3.34959638669998014393e+01 5.11201022495396562029e-01        2.752818        2.890732        0.696632 327
1.55439169709782581963e-01 -3.34597828176051876881e+01 4.95726640041349031485e-01        2.890732        3.193193        0.711999 340
1.55246972900249524674e-01 -3.34580530463194492086e+01 4.94886233770117034414e-01        3.193193        3.277325        0.712776 341
1.35594849125504346432e-01 -3.32681625985008935231e+01 3.93428768031878650646e-01        3.277325        3.445712        0.794327 373
1.34970209494522208615e-01 -3.32612915625599541158e+01 3.89345353176778541382e-01        3.445712        3.881052        0.797190 374
1.34922160292139270421e-01 -3.32605708245242936982e+01 3.88877324981969474393e-01        3.881052        3.969681        0.797510 375
1.34778012684989595416e-01 -3.32582644628098975659e+01 3.87356959924041843735e-01        3.969681        4.052192        0.798544 376
1.34585815875456371593e-01 -3.32549971170478499971e+01 3.85172864474501441823e-01        4.052192        4.129502        0.800020 377
1.34441668268306668832e-01 -3.32524024601191214856e+01 3.83416559484284380499e-01        4.129502        4.271297        0.801199 378
1.34249471458773722565e-01 -3.32485585239284588965e+01 3.80762033842913405479e-01        4.271297        4.658644        0.802968 379
1.33144339803959149693e-01 -3.32189121660580894968e+01 3.59233774317360032846e-01        4.658644        4.780143        0.816917 383
1.31750912934845088031e-01 -3.31777339996155689050e+01 3.28383170259500756227e-01        4.780143        4.839472        0.836080 388
1.31702863732462260860e-01 -3.31762444743416580195e+01 3.27248197659544992622e-01        4.839472        4.880513        0.836768 389
1.31654814530078434487e-01 -3.31747068998654413008e+01 3.26072037448303264640e-01        4.880513        5.101975        0.837479 390
1.31606765327695302004e-01 -3.31728810301749064138e+01 3.24653196031910729058e-01        5.101975        5.167276        0.838334 391
1.31510666922929064793e-01 -3.31690370939841372433e+01 3.21649659899450546252e-01        5.167276        5.179111        0.840135 392
1.31270420911012236642e-01 -3.31593311551027412065e+01 3.14031165294480496541e-01        5.179111        5.191660        0.844671 394
1.29108206803767167070e-01 -3.30706803767057522236e+01 2.42480630139943836854e-01        5.191660        5.275984        0.885100 409
1.29012108399000513526e-01 -3.30664520468960319022e+01 2.38967222780567617457e-01        5.275984        5.359467        0.886992 410
1.28964059196617186753e-01 -3.30641937343839487085e+01 2.37079688970349533594e-01        5.359467        5.412012        0.888004 411
1.28916009994234165292e-01 -3.30618393234672041103e+01 2.35104553551296086011e-01        5.412012        5.437291        0.889060 412
1.28867960791850783009e-01 -3.30594368633480470976e+01 2.33084285824037173995e-01        5.437291        5.602047        0.890138 413
1.28819911589467650526e-01 -3.30566980588121310802e+01 2.30761774456912788223e-01        5.602047        5.605340        0.891373 414
1.27858927541802530614e-01 -3.30016336728809775991e+01 1.83374053103977224799e-01        5.605340        5.616534        0.915861 420
1.27570632327503319381e-01 -3.29849125504517246554e+01 1.68721685093840695346e-01        5.616534        5.627821        0.923173 421
1.26513549875072267570e-01 -3.29228329809724584720e+01 1.13276728795976555642e-01        5.627821        5.630086        0.949838 433
1.26465500672688746508e-01 -3.29199980780318881557e+01 1.10706625347947895666e-01        5.630086        5.646076        0.951038 434
1.26225254660772306936e-01 -3.29056313665192448070e+01 9.76235131619318796670e-02        5.646076        5.736423        0.957096 436
1.26081107053622881731e-01 -3.28963578704593331281e+01 8.91058885607394074446e-02        5.736423        5.804514        0.960999 438
1.25888910244089768931e-01 -3.28832884874110931150e+01 7.70141981052855501000e-02        5.804514        5.821192        0.966483 439
1.25648664232173468136e-01 -3.28667115125888997795e+01 6.15691808997771358736e-02        5.821192        5.923763        0.973397 440
1.25552565827407175414e-01 -3.28595041322314003196e+01 5.47974729437049543068e-02        5.923763        5.998445        0.976396 441
1.25072073803574906892e-01 -3.28211608687295068876e+01 1.83407015484309092457e-02        5.998445        6.030046        0.992228 447
1.25024024601191691142e-01 -3.28172208341340549964e+01 1.45578139622673553844e-02        6.030046        6.162777        0.993841 448
1.23486450124927982230e-01 -3.26760522775321220479e+01 -1.25477057405439462734e-01        6.162777        6.185120        1.050091 467
1.23438400922544835869e-01 -3.26715356525081261907e+01 -1.30086428596269926272e-01        6.185120        6.197346        1.051837 468
1.23294253315394702897e-01 -3.26578416298290008513e+01 -1.44112708873882999772e-01        6.197346        6.247306        1.057115 469
1.23246204113011390002e-01 -3.26530847587930139753e+01 -1.49007203972422563876e-01        6.247306        6.259245        1.058944 470
1.23198154910628451808e-01 -3.26482798385546715281e+01 -1.53961105830992039945e-01        6.259245        6.282516        1.060788 471
1.23005958101095075330e-01 -3.26286757639823861155e+01 -1.74273116111499898340e-01        6.282516        6.304432        1.068279 475
1.22765712089179468425e-01 -3.26036901787429940214e+01 -2.00380633227565135845e-01        6.304432        6.360528        1.077746 476
1.22669613684412925902e-01 -3.25932154526235038361e+01 -2.11407515115488747748e-01        6.360528        6.376384        1.081693 477
1.22573515279646785836e-01 -3.25825965788967977232e+01 -2.22631025749389033219e-01        6.376384        6.391159        1.085678 479
1.19882759946184774824e-01 -3.22784931770132459405e+01 -5.61040769050588083999e-01        6.391159        6.398352        1.193292 511
1.19402267922352589569e-01 -3.22232365942725138552e+01 -6.25886313774864144754e-01        6.398352        6.417245        1.211604 517
1.19354218719969068507e-01 -3.22176148375937145829e+01 -6.32541304885213429010e-01        6.417245        6.494884        1.213449 518
1.19162021910436261019e-01 -3.21936382856043934453e+01 -6.61080438011330984160e-01        6.494884        6.506000        1.221289 522
1.19113972708053086902e-01 -3.21875840861041595531e+01 -6.68317206829710963589e-01        6.506000        6.531672        1.223259 523
1.18777628291370507263e-01 -3.21442437055545013891e+01 -7.20486642351614414714e-01        6.531672        6.543556        1.237251 527
1.18537382279454192591e-01 -3.21129156256006069725e+01 -7.58572049473974718836e-01        6.543556        6.566385        1.247242 532
1.18489333077070782552e-01 -3.21065250816836353920e+01 -7.66381665967309388954e-01        6.566385        6.593220        1.249268 533
1.18441283874687677824e-01 -3.20999903901595473599e+01 -7.74384251851303773151e-01        6.593220        6.645503        1.251337 534
1.18393234672304614730e-01 -3.20931674034210203672e+01 -7.82761357168365479176e-01        6.645503        6.656181        1.253495 535
1.18008841053238527907e-01 -3.20380069190851841654e+01 -8.51024383871201939300e-01        6.656181        6.662283        1.270765 541
1.17912742648472013141e-01 -3.20241206995963594295e+01 -8.68357180836648256950e-01        6.662283        6.666957        1.275064 543
=new cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
9.70161445320006365911e-01 -3.51810493945801212590e+01 0.00000000000000000000e+00            -inf        0.815395            -inf 0
3.48885258504707918004e-01 -3.41318950605419928479e+01 5.48651228557115233642e-01        0.815395        1.578029        0.477054 205
1.94455122044973421902e-01 -3.36620699596386785402e+01 5.55528680202168834157e-01        1.578029        1.987869        0.634275 281
1.94407072842590594730e-01 -3.36618777628291709902e+01 5.55497375365702650285e-01        1.987869        2.256400        0.634342 282
1.63127042091101570609e-01 -3.35125408418220516182e+01 5.17215713986802994029e-01        2.256400        2.487242        0.690013 319
1.61733615221987120369e-01 -3.35047568710359300326e+01 5.14615315853340749008e-01        2.487242        2.659388        0.693004 321
1.61349221602921533147e-01 -3.35023544109167019656e+01 5.13718283209791515276e-01        2.659388        2.752818        0.693978 325
1.60388237555256829570e-01 -3.34959638669998014393e+01 5.11201022495396562029e-01        2.752818        2.890732        0.696632 327
1.55439169709782581963e-01 -3.34597828176051876881e+01 4.95726640041349031485e-01        2.890732        3.193193        0.711999 340
1.55246972900249524674e-01 -3.34580530463194492086e+01 4.94886233770117034414e-01        3.193193        3.277325        0.712776 341
1.35594849125504346432e-01 -3.32681625985008935231e+01 3.93428768031878650646e-01        3.277325        3.445712        0.794327 373
1.34970209494522208615e-01 -3.32612915625599541158e+01 3.89345353176778541382e-01        3.445712        3.881052        0.797190 374
1.34922160292139270421e-01 -3.32605708245242936982e+01 3.88877324981969474393e-01        3.881052        3.969681        0.797510 375
1.34778012684989595416e-01 -3.32582644628098975659e+01 3.87356959924041843735e-01        3.969681        4.052192        0.798544 376
1.34585815875456371593e-01 -3.32549971170478499971e+01 3.85172864474501441823e-01        4.052192        4.129502        0.800020 377
1.34441668268306668832e-01 -3.32524024601191214856e+01 3.83416559484284380499e-01        4.129502        4.271297        0.801199 378
1.34249471458773722565e-01 -3.32485585239284588965e+01 3.80762033842913405479e-01        4.271297        4.658644        0.802968 379
1.33144339803959149693e-01 -3.32189121660580894968e+01 3.59233774317360032846e-01        4.658644        4.780143        0.816917 383
1.31750912934845088031e-01 -3.31777339996155689050e+01 3.28383170259500756227e-01        4.780143        4.839472        0.836080 388
1.31702863732462260860e-01 -3.31762444743416580195e+01 3.27248197659544992622e-01        4.839472        4.880513        0.836768 389
1.31654814530078434487e-01 -3.31747068998654413008e+01 3.26072037448303264640e-01        4.880513        5.101975        0.837479 390
1.31606765327695302004e-01 -3.31728810301749064138e+01 3.24653196031910729058e-01        5.101975        5.167276        0.838334 391
1.31510666922929064793e-01 -3.31690370939841372433e+01 3.21649659899450546252e-01        5.167276        5.179111        0.840135 392
1.31270420911012236642e-01 -3.31593311551027412065e+01 3.14031165294480496541e-01        5.179111        5.191660        0.844671 394
1.29108206803767167070e-01 -3.30706803767057522236e+01 2.42480630139943836854e-01        5.191660        5.275984        0.885100 409
1.29012108399000513526e-01 -3.30664520468960319022e+01 2.38967222780567617457e-01        5.275984        5.359467        0.886992 410
1.28964059196617186753e-01 -3.30641937343839487085e+01 2.37079688970349533594e-01        5.359467        5.412012        0.888004 411
1.28916009994234165292e-01 -3.30618393234672041103e+01 2.35104553551296086011e-01        5.412012        5.437291        0.889060 412
1.28867960791850783009e-01 -3.30594368633480470976e+01 2.33084285824037173995e-01        5.437291        5.602047        0.890138 413
1.28819911589467650526e-01 -3.30566980588121310802e+01 2.30761774456912788223e-01        5.602047        5.605340        0.891373 414
1.27858927541802530614e-01 -3.30016336728809775991e+01 1.83374053103977224799e-01        5.605340        5.616534        0.915861 420
1.27570632327503319381e-01 -3.29849125504517246554e+01 1.68721685093840695346e-01        5.616534        5.627821        0.923173 421
1.26513549875072267570e-01 -3.29228329809724584720e+01 1.13276728795976555642e-01        5.627821        5.630086        0.949838 433
1.26465500672688746508e-01 -3.29199980780318881557e+01 1.10706625347947895666e-01        5.630086        5.646076        0.951038 434
1.26225254660772306936e-01 -3.29056313665192448070e+01 9.76235131619318796670e-02        5.646076        5.736423        0.957096 436
1.26081107053622881731e-01 -3.28963578704593331281e+01 8.91058885607394074446e-02        5.736423        5.804514        0.960999 438
1.25888910244089768931e-01 -3.28832884874110931150e+01 7.70141981052855501000e-02        5.804514        5.821192        0.966483 439
1.25648664232173468136e-01 -3.28667115125888997795e+01 6.15691808997771358736e-02        5.821192        5.923763        0.973397 440
1.25552565827407175414e-01 -3.28595041322314003196e+01 5.47974729437049543068e-02        5.923763        5.998445        0.976396 441
1.25072073803574906892e-01 -3.28211608687295068876e+01 1.83407015484309092457e-02        5.998445        6.030046        0.992228 447
1.25024024601191691142e-01 -3.28172208341340549964e+01 1.45578139622673553844e-02        6.030046        6.162777        0.993841 448
1.23486450124927982230e-01 -3.26760522775321220479e+01 -1.25477057405439462734e-01        6.162777        6.185120        1.050091 467
1.23438400922544835869e-01 -3.26715356525081261907e+01 -1.30086428596269926272e-01        6.185120        6.197346        1.051837 468
1.23294253315394702897e-01 -3.26578416298290008513e+01 -1.44112708873882999772e-01        6.197346        6.247306        1.057115 469
1.23246204113011390002e-01 -3.26530847587930139753e+01 -1.49007203972422563876e-01        6.247306        6.259245        1.058944 470
1.23198154910628451808e-01 -3.26482798385546715281e+01 -1.53961105830992039945e-01        6.259245        6.282516        1.060788 471
1.23005958101095075330e-01 -3.26286757639823861155e+01 -1.74273116111499898340e-01        6.282516        6.304432        1.068279 475
1.22765712089179468425e-01 -3.26036901787429940214e+01 -2.00380633227565135845e-01        6.304432        6.360528        1.077746 476
1.22669613684412925902e-01 -3.25932154526235038361e+01 -2.11407515115488747748e-01        6.360528        6.376384        1.081693 477
1.22573515279646785836e-01 -3.25825965788967977232e+01 -2.22631025749389033219e-01        6.376384        6.391159        1.085678 479
1.19882759946184774824e-01 -3.22784931770132459405e+01 -5.61040769050588083999e-01        6.391159        6.398352        1.193292 511
1.19402267922352589569e-01 -3.22232365942725138552e+01 -6.25886313774864144754e-01        6.398352        6.417245        1.211604 517
1.19354218719969068507e-01 -3.22176148375937145829e+01 -6.32541304885213429010e-01        6.417245        6.494884        1.213449 518
1.19162021910436261019e-01 -3.21936382856043934453e+01 -6.61080438011330984160e-01        6.494884        6.506000        1.221289 522
1.19113972708053086902e-01 -3.21875840861041595531e+01 -6.68317206829710963589e-01        6.506000        6.531672        1.223259 523
1.18777628291370507263e-01 -3.21442437055545013891e+01 -7.20486642351614414714e-01        6.531672        6.543556        1.237251 527
1.18537382279454192591e-01 -3.21129156256006069725e+01 -7.58572049473974718836e-01        6.543556        6.566385        1.247242 532
1.18489333077070782552e-01 -3.21065250816836353920e+01 -7.66381665967309388954e-01        6.566385        6.593220        1.249268 533
1.18441283874687677824e-01 -3.20999903901595473599e+01 -7.74384251851303773151e-01        6.593220        6.645503        1.251337 534
1.18393234672304614730e-01 -3.20931674034210203672e+01 -7.82761357168365479176e-01        6.645503        6.656181        1.253495 535
1.18008841053238527907e-01 -3.20380069190851841654e+01 -8.51024383871201939300e-01        6.656181        6.662283        1.270765 541
1.17912742648472013141e-01 -3.20241206995963594295e+01 -8.68357180836648256950e-01        6.662283        6.666957        1.275064 543
")
ggplot()+
  geom_vline(aes(xintercept=min_log_mean, color=fun),
             data=C1.60minenv$vlines)+
  geom_line(aes(log.mean, cost, color=fun),
            size=2,
            data=C1.60minenv$funs)


C1.60minenv <- gdata("
=cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
9.99999999999999888978e-01 -3.04876615746180945621e+00 0.00000000000000000000e+00            -inf        1.189116             inf 56
7.16803760282021112937e-02 0.00000000000000000000e+00 -5.76570928152859929483e-01        1.189116        1.204649        1.189116 58
8.96004700352526439744e-01 -3.04876615746180945621e+00 0.00000000000000000000e+00        1.204649        1.493913            -inf 0
8.78965922444183145323e-01 -3.03172737955346693894e+00 5.04446708726733333839e-02        1.493913        1.562189       -1.960580 1
3.17861339600470027555e-01 -1.42361927144535838075e+00 2.14323509143853258019e-01        1.562189        1.602478        0.868121 36
3.05522914218566477018e-01 -1.38014101057579341436e+00 2.05914795383460108580e-01        1.602478        2.358202        0.876596 38
7.16803760282021112937e-02 0.00000000000000000000e+00 -5.76570928152859929483e-01        2.358202        3.555348        1.189116 58
")
ggplot()+
  coord_cartesian(xlim=c(1, 2), ylim=c(-1, 0))+
  geom_vline(aes(xintercept=min_log_mean, color=fun),
             data=C1.60minenv$vlines)+
  geom_line(aes(log.mean, cost, color=fun),
            size=2,
            data=C1.60minenv$funs)

C1.1 <- gdata("
=prev cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
1.00000000000000000000e+00 -0.00000000000000000000e+00 0.00000000000000000000e+00            -inf        3.555348        0.000000 -1
=new cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
0.00000000000000000000e+00 0.00000000000000000000e+00 0.00000000000000000000e+00            -inf        3.555348            -inf 0
")
ggplot()+
  geom_line(aes(log.mean, cost, color=fun),
            size=2,
            data=C1.1$funs)

C1.2prev <- gdata("
=prev cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
1.00000000000000000000e+00 -1.40776699029126206586e-01 0.00000000000000000000e+00            -inf        3.555348        0.000000 -1
=min prev cost
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
1.00000000000000000000e+00 -1.40776699029126206586e-01 0.00000000000000000000e+00            -inf       -1.960580             inf 1
0.00000000000000000000e+00 0.00000000000000000000e+00 4.16780727307233478385e-01       -1.960580        3.555348       -1.960580 1
")
ggplot()+
  geom_vline(aes(xintercept=min_log_mean, color=fun),
             data=C1.2prev$vlines)+
  geom_line(aes(log.mean, cost, color=fun),
            size=2,
            data=C1.2prev$funs)

C1.54 <- gdata("
=min prev cost
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
6.78554521066750820912e-03 0.00000000000000000000e+00 1.17256803266681891573e-01            -inf      -44.368374             inf 209
1.11251380779548686428e-01 -6.31213507969070625886e-03 -1.62802368939145597482e-01      -44.368374       -3.025947             inf 209
1.55594129714375889462e-01 -3.77150071011519635866e-02 -2.59976955043114466015e-01       -3.025947       -1.417193             inf 209
0.00000000000000000000e+00 0.00000000000000000000e+00 -1.68812511325519581940e-01       -1.417193        3.555348       -1.417193 209
=cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
1.30976802903582136006e-02 -6.31213507969070625886e-03 -1.62802368939145597482e-01            -inf       -2.859501            -inf 207
1.41865235916048632037e-01 -3.77150071011519635866e-02 -2.59976955043114466015e-01       -2.859501       -0.992364            -inf 203
1.30976802903582136006e-02 -6.31213507969070625886e-03 -1.81079822644533677822e-01       -0.992364        0.975518       -1.512418 207
6.78554521066750820912e-03 0.00000000000000000000e+00 -1.70494226206477972330e-01        0.975518        3.555348       -1.372603 208
=new cost model
    Linear        Log        Constant    min_log_mean    max_log_mean   prev_log_mean data_i
1.30976802903582136006e-02 -6.31213507969070625886e-03 -1.62802368939145597482e-01            -inf       -2.859501            -inf 207
1.41865235916048632037e-01 -3.77150071011519635866e-02 -2.59976955043114466015e-01       -2.859501       -0.992364            -inf 203
1.30976802903582136006e-02 -6.31213507969070625886e-03 -1.81079822644533677822e-01       -0.992364       -0.140584       -1.512418 207
0.00000000000000000000e+00 0.00000000000000000000e+00 -1.68812511325519581940e-01       -0.140584        3.555348       -1.417193 209
")
ggplot()+
  geom_vline(aes(xintercept=min_log_mean, color=fun),
             data=C1.54$vlines)+
  geom_line(aes(log.mean, cost, color=fun),
            size=2,
            data=C1.54$funs)
